#!/bin/bash
# simple volume notification script
#
pid="1283"
iconpath="/usr/share/icons/Papirus/48x48/status/"
vol_high="notification-audio-volume-high.svg"
vol_med="notification-audio-volume-medium.svg"
vol_low="notification-audio-volume-low.svg"
muted="notification-audio-volume-muted.svg"
nothead="Volume:"
incr=10

geticon(){
if (( $vol > 66 ))
    then
        icon=$vol_high
        	else
        	    if (( $vol < 33  ))
            then icon=$vol_low
    	    else
    		icon=$vol_med
    	    fi
fi
}

get_status(){
	STAT=$(pulsemixer -l | grep "Sink:" | awk '{print $10}' | sed  's/,//')
}

mute(){
if [ $STAT == 0 ] ;
    then
        icon=$muted
        text="muted"
        pulsemixer --mute
    else
       vol=$(pulsemixer --get-volume --id sink-0 | awk '{print $1}')
       geticon
       text="$vol"%
       pulsemixer --unmute
fi
}

up(){
if [ $STAT == 0 ] ;
    then
        vol=$(pulsemixer --get-volume --id sink-0 | awk '{print $1}')
        ost=$((100 - $vol))
            if (($ost < $incr )) ;
                then
    	        geticon
    	        pulsemixer --set-volume 100
                    vol=100
    	    else
    	        pulsemixer --change-volume +$incr
                    vol=$(pulsemixer --get-volume --id sink-0 | awk '{print $1}')
    		geticon
    	fi
	    text="$vol"%
    else
        icon=$muted
        text="muted"
fi
}

down(){
if [ $STAT == 0 ] ;
    then
        vol=$(pulsemixer --get-volume --id sink-0 | awk '{print $1}')
            if (($vol < $incr )) ;
                then
      	            geticon
		    pulsemixer --set-volume 0
	            vol=0
		else
		    pulsemixer --change-volume -$incr
	            vol=$(pulsemixer --get-volume --id sink-0 | awk '{print $1}')
		    geticon
	    fi
    	text="$vol"%
    else
	icon=$muted
	text="muted"
    fi
}

get_status

case  $1 in
	mute) mute ;;
	up) up ;;
	down) down;;
esac

dunstify -i $iconpath$icon  -r $pid $nothead $text

